#!/usr/bin/env sh

# -- General Configuration --
# Disable animations completely
yabai -m config window_animation_duration 0.0
yabai -m config window_animation_frame_rate 0

# -- Performance Optimizations --
# Disable window opacity for better performance
yabai -m config window_opacity off
yabai -m config window_opacity_duration 0.0
yabai -m config active_window_opacity 1.0
yabai -m config normal_window_opacity 1.0

# Disable window shadows for performance
yabai -m config window_shadow off

# Disable borders for performance
yabai -m config window_border off
yabai -m config window_border_width 0

# -- Layout Configuration --
# Tiling mode (bsp, stack or float)
yabai -m config layout bsp

# No padding or gaps for maximum screen space
yabai -m config top_padding 0
yabai -m config bottom_padding 0
yabai -m config left_padding 0
yabai -m config right_padding 0
yabai -m config window_gap 0

# -- Focus Behavior --
# Disable mouse follows focus for less resource usage
yabai -m config mouse_follows_focus off
yabai -m config focus_follows_mouse off

# Window placement
yabai -m config window_placement second_child
yabai -m config window_topmost off
yabai -m config split_ratio 0.50
yabai -m config auto_balance off

# -- Application Rules --
# Exclude system apps and resource-intensive apps from management
yabai -m rule --add app="^System Settings$" manage=off
yabai -m rule --add app="^System Preferences$" manage=off
yabai -m rule --add app="^App Store$" manage=off
yabai -m rule --add app="^Activity Monitor$" manage=off
yabai -m rule --add app="^Calculator$" manage=off
yabai -m rule --add app="^Finder$" title="(Co(py|nnect)|Move|Info|Pref)" manage=off
yabai -m rule --add app="^Preview$" manage=off
yabai -m rule --add app="^Disk Utility$" manage=off
yabai -m rule --add app="^Safari$" title="^(General|(Tab|Password|Website|Extension)s|AutoFill|Se(arch|curity)|Privacy|Advance)$" manage=off
yabai -m rule --add app="^Chrome$" title="^(Settings|History|Downloads)" manage=off
yabai -m rule --add app="^Code$" manage=on
yabai -m rule --add app="^Spotify$" manage=off
yabai -m rule --add app="^Adobe" manage=off

# -- Set macOS to be faster --
# Reduce transition animation time
defaults write com.apple.dock workspaces-edge-delay -float 0.0
defaults write com.apple.dock expose-animation-duration -float 0.0

# -- Signal Handling --
# Restart Dock to apply changes
killall Dock

echo "yabai configuration loaded successfully"
